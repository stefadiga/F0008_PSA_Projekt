---
title: "Exploratorische Analyse PSA-Screening"
author: "sd"
date: "April 2017"
output:
  word_document:
    toc: yes
  pdf_document:
    toc: yes
  html_document:
    figure_caption: yes
    toc: yes
    word_document: default
---



```{r echo=FALSE, warning=FALSE, message=FALSE}
load(".RData")
#myLibR <- "C:/01_Fire/10_Libraries/RLib"
#.libPaths(myLibR)

library(knitr)
library(lattice)
library(xtable)
library(pander)
library(lme4)
library(ggplot2)
# library(pbkrtest)
# library(sjPlot)
library(sqldf)

```

# Selektionskriterien


# Berechnung Personenjahre


# Verteilung wiederholte Messungen / Observed follow up
```{r echo=FALSE, warning=FALSE, message=FALSE}
# Anzahl Zeilen und Werte
pander(count_psa, justify=c('left', 'right'))

```

# Verteilung wiederholte Messungen / Study period follow up
```{r echo=FALSE, warning=FALSE, message=FALSE}
# Anzahl Zeilen und Werte
pander(count_psa_2, justify=c('left', 'right'))

```
# Verteilung wiederholte Messungen / Mixed follow up
```{r echo=FALSE, warning=FALSE, message=FALSE}
# Anzahl Zeilen und Werte
pander(count_psa_3, justify=c('left', 'right'))

```
# Inzidenzrate (PSA-Messung/1 py) über alles
```{r echo=FALSE, warning=FALSE, message=FALSE}
# Anzahl Zeilen und Werte
pander(tab1, justify=c('left', rep('right',5)))

```


# Inzidenzrate (PSA-Messung/1 py)  über alles (Eligibility >= 3 months)
![Fig 3](plot_a00xa1_ir.jpg)


# Inzidenzrate Arzt/Ärztin
```{r echo=FALSE, warning=FALSE, message=FALSE}
# Anzahl Zeilen und Werte
pander(tab2, justify=c('left', rep('right',6)))

```
```{r echo=FALSE, warning=FALSE, message=FALSE}
poisson.test(tab2$n_psa,tab2$py)

```
# Inzidenzrate Arzt/Ärztin
![Fig 4](plot_a00xa2_ir.jpg)

# Inzidenzrate Gemeindetypologie
```{r echo=FALSE, warning=FALSE, message=FALSE}
# Anzahl Zeilen und Werte
pander(subset(tab3), justify=c('left', rep('right',6)))

```
```{r echo=FALSE, warning=FALSE, message=FALSE}
poisson.test(c(tab3$n_psa[1], tab3$n_psa[3]),c(tab3$py[1], tab3$py[3]))
poisson.test(c(tab3$n_psa[1], tab3$n_psa[4]),c(tab3$py[1], tab3$py[4]))
poisson.test(c(tab3$n_psa[4], tab3$n_psa[3]),c(tab3$py[4], tab3$py[3]))

```
# Inzidenzrate Gemeindetypologie (Other=RE, MIX, AGR)
![Fig 5](plot_a00xa3_ir.jpg)

# Inzidenzrate Praxisart
```{r echo=FALSE, warning=FALSE, message=FALSE}
# Anzahl Zeilen und Werte
pander(tab4, justify=c('left', rep('right',6)))

```
```{r echo=FALSE, warning=FALSE, message=FALSE}
poisson.test(c(tab4$n_psa[1], tab4$n_psa[2]+tab4$n_psa[3]),c(tab4$py[1], tab4$py[2]+tab4$py[3]))

```

# Inzidenzrate Praxisart
![Fig 6](plot_a00xa4_ir.jpg)


# Inzidenzrate Angestelltenverhältnis
```{r echo=FALSE, warning=FALSE, message=FALSE}
# Anzahl Zeilen und Werte
pander(tab5, justify=c('left', rep('right',6)))

```

```{r echo=FALSE, warning=FALSE, message=FALSE}
poisson.test(c(tab5$n_psa[1], tab5$n_psa[2]),c(tab5$py[1], tab5$py[2]))
```

# Inzidenzrate Angestelltenverhältnis
![Fig 7](plot_a00xa5_ir.jpg)

# Inzidenzrate Jahrgang Arzt
```{r echo=FALSE, warning=FALSE, message=FALSE}
# Anzahl Zeilen und Werte
pander(tab6, justify=c('left', rep('right',6)))

```
```{r echo=FALSE, warning=FALSE, message=FALSE}
poisson.test(c(tab6$n_psa[1]+tab6$n_psa[2], tab6$n_psa[3]),c(tab6$py[1]+tab6$py[2], tab6$py[3]))
poisson.test(c(tab6$n_psa[3], tab6$n_psa[4]+tab6$n_psa[5]),c(tab6$py[3], tab6$py[4]+tab6$py[5]))
poisson.test(c(tab6$n_psa[1]+tab6$n_psa[2], tab6$n_psa[4]+tab6$n_psa[5]),c(tab6$py[1]+tab6$py[2], tab6$py[4]+tab6$py[5]))
```

# Inzidenzrate Jahrgang Arzt
![Fig 8](plot_a00xa6_ir.jpg)

# Inzidenzrate Alter Patient (age at study entry)

```{r echo=FALSE, warning=FALSE, message=FALSE}
# Anzahl Zeilen und Werte
pander(tab7, justify=c('left', rep('right',6)))

```
```{r echo=FALSE, warning=FALSE, message=FALSE}
# Anzahl Zeilen und Werte
summary(pois.b<-glm(events.2~age,offset=log(py.2),data=inc_pat_age,family="poisson"))


```
# Inzidenzrate Alter Patient (age during study)

```{r echo=FALSE, warning=FALSE, message=FALSE}
# Anzahl Zeilen und Werte
pander(tab8, justify=c('left', rep('right',6)))

```

```{r echo=FALSE, warning=FALSE, message=FALSE}
# Anzahl Zeilen und Werte
summary(pois.b<-glm(events~class_age,offset=log(py),data=inc_pat_age_c,family="poisson"))

```

# Inzidenzrate Alter Patient (at study entry)
![Fig 9.a](plot_a00xa7.0_ir.jpg)

# Inzidenzrate Alter Patient
![Fig 9.b](plot_a00xa7_ir.jpg)


# PSA-Wert: Median, 75%- und 90%- Quantil 
![Fig 10](a00xa0_3_1_psa_quantile.jpg)

# PSA-Wert: Boxplot Log (PSA)
![Fig 10.2](a00xa0_3_1_3_psa_quantile.jpg)

# PSA-Wert: Violin plot (Log PSA)
![Fig 10.3](a00xa0_3_1_4_psa_quantile.jpg)

#PSA-Wert: Box plot Im trimester (Log PSA)
![Fig 10.4](a00xa0_3_1_5_psa_quantile.jpg)


#PSA-Wert: Plot (Log PSA) + smooth
![Fig 10.5](a00xa0_3_1_6_psa_quantile.jpg)

# PSA-Wert: Median, 75%- und 90%- Quantil / Arzt/Ärztin
![Fig 11](plot_a002a2_3_psa_quantile.jpg)



# PSA-Wert: Median, 75%- und 90%- Quantil / Region
![Fig 12](plot_a002a3_3_psa_quantile.jpg)


# PSA-Wert: Median, 75%- und 90%- Quantil / Praxisart
![Fig 13](plot_a002a4_3_psa_quantile.jpg)


# PSA-Wert: Median, 75%- und 90%- Quantil / Arbeitsverhältnis
![Fig 14](plot_a002a5_3_psa_quantile.jpg)

# PSA-Wert: Median, 75%- und 90%- Quantil / Arzt Alter
![Fig 14](plot_a002a6_3_psa_quantile.jpg)
# PSA-Wert: Median, 75%- und 90%- Quantil / Patient Alter (at study entry)
![Fig 14](plot_a002a7_3_psa_quantile.jpg)
# PSA-Wert:Im Patients
![Fig 15](plot_psa_id.jpg)
